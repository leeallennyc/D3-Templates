d3.csv('/data/original.csv').then(data => {
    const div = d3.select('body')
    const margin = { top: 250, right: 250, bottom: 250, left: 250}
    const width = window.innerWidth - margin.right - margin.left
    const height = window.innerHeight - margin.top - margin.bottom
    const svg = div.append('svg')
        .attr('width', width + margin.left + margin.right)
        .attr('height', height + margin.top + margin.bottom)
        .append('g')
            .attr('transform', `translate(${margin.left}, ${margin.bottom})`)

        const xScale = d3.scaleLinear()
            .domain([0, d3.max(data.map(d => +d.patentNumber))])
            .rangeRound([0, width])

        const yScale = d3.scaleBand()
            .domain(data.map(d => d.country))
            .range([height, 0])
            .padding(0.1)

        const xAxis = svg.append('g')
            .attr('class', 'x axis')
            .attr('transform', `translate(0, ${height})`)
            .call(d3.axisBottom(xScale))
            .append('text')
                .attr('x', width/2)
                .attr('y', 40)
                .attr('dy', '0.7em')
                .style('text-anchor', 'middle')
                .style('fill', 'gray')
                .text('Visitors Per Country')
                
        
        const yAxis = svg.append('g')
            .attr('class', 'y axis')
            .call(d3.axisLeft(yScale))

        const bars = svg.selectAll('.bar')
            .data(data)
            .enter().append('rect')
            .attr('class', 'bar')
            .attr('x', width)
            .attr('y', d => yScale(d.country))
            .attr('height', d => yScale.bandwidth())
            .attr('width', d => xScale(+d.patentNumber))
            .style('fill', 'orange')
            .style('opacity', 1)
            .on('mouseover', function (d, i) {
                d3.selectAll('.patentNumber')
                    // .attr('dx', 25)
                    .transition().duration(1500)
                    .style('fill', 'orange')
                d3.select(this)
                    .transition().duration(1500)
                    .style('fill', 'floralwhite')
            }) 
           .on('mouseout', function (d, i) {
                
                d3.selectAll('.patentNumber')
                    // .attr('dx', -25)
                    .transition().duration(1500)
                    .style('fill', 'floralwhite')
                d3.select(this)
                    .transition().duration(1500)
                    .style('fill', 'orange')
                    .style('opacity', 1)     
            })
            // Transition from Right to X axis = 0
            .transition().duration(100).delay((d, i) => i * 50)
            .attr('y', d => yScale(d.country))
            .transition().duration(100).delay((d, i) => i * 50)
            .attr('x', 0)
            //  .attr('y', 0)
            
        const text = svg.selectAll('.patentNumber')
            .data(data)
            .enter().append('text')
            .attr('class', 'patentNumber')
            .attr('x', d => xScale(d.patentNumber))
            .attr('y', d => yScale(d.country))
            .attr('dx', -20)
            .attr('dy', (yScale.bandwidth() / 2 )+5)
            .text(d => d.patentNumber)
            .style('opacity', 0)
            .transition().duration(750).delay((d, i) => i * 75)
            .style('opacity', 1)
            .style('text-anchor', 'middle')
            .style('font-family', 'verdana')
             

        const title = svg.append('text')
            .attr('x', width/2)
            .attr('y', -40)
            .style('text-anchor', 'middle')
            .style('fill', 'floralwhite')
            .style('font-family', 'verdana')
            .text('Visitors Per Country')

})